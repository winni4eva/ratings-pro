{"version":3,"sources":["admin2/report/report.component.ts"],"names":[],"mappings":"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","file":"admin2/report/report.component.js","sourcesContent":["import {Component, OnInit, OnDestroy} from '@angular/core';\r\nimport { ZingChart } from '../chart/zingchart.component';\r\nimport { Chart } from '../chart/chart.model';\r\nimport { ReportService } from './report.service';\r\nimport { NotificationsService } from 'angular2-notifications';\r\nimport { FileService } from '../../shared/file-generator/file.service';\r\n\r\n   @Component({\r\n       selector : 'my-report',\r\n       template:  `\r\n       <style>\r\n            #exTab1 .tab-content {\r\n            color : white;\r\n            background-color: white;\r\n            padding : 5px 15px;\r\n            }\r\n\r\n            #exTab2 h3 {\r\n            color : white;\r\n            background-color: white;\r\n            padding : 5px 15px;\r\n            }\r\n\r\n            /* remove border radius for the tab */\r\n\r\n            #exTab1 .nav-pills > li > a {\r\n            border-radius: 0;\r\n            }\r\n\r\n            /* change border radius for the tab , apply corners on top*/\r\n\r\n            #exTab3 .nav-pills > li > a {\r\n            border-radius: 4px 4px 0 0 ;\r\n            }\r\n\r\n            #exTab3 .tab-content {\r\n            color : white;\r\n            background-color: white;\r\n            padding : 5px 15px;\r\n            }\r\n       </style>\r\n          \r\n          <simple-notifications [options]=\"_options\"></simple-notifications>\r\n\r\n          <!--<zingchart [chart]=\"lineChart\"></zingchart>-->\r\n\r\n            <my-content [title]=\"'Report'\">\r\n\r\n                <div id=\"exTab1\" class=\"\">\t\r\n                <ul  class=\"nav nav-pills\">\r\n                    <li class=\"active\">\r\n                        <a  href=\"#1a\" data-toggle=\"tab\" (click)=\"clickedTab='Overview';updateReport()\">Overview</a>\r\n                    </li>\r\n                    <li>\r\n                        <a href=\"#2a\" data-toggle=\"tab\" (click)=\"clickedTab='Surveys';updateReport()\">Surveys</a>\r\n                    </li>\r\n                    <li>\r\n                        <a href=\"#3a\" data-toggle=\"tab\" (click)=\"clickedTab='Ratings';updateReport()\">Ratings</a>\r\n                    </li>\r\n                    <li>\r\n                        <a href=\"#4a\" data-toggle=\"tab\" (click)=\"clickedTab='Branches';updateReport()\">Branches</a>\r\n                    </li>\r\n                </ul>\r\n\r\n                <div class=\"img-thumbnail\" style=\"width:200%\">\r\n                    <my-date-picker [options]=\"myDatePickerOptions\" (dateChanged)=\"onDateChanged($event,'to')\" *ngIf=\"fromDatePickerSet\" class=\"pull-right\"></my-date-picker>\r\n                    <my-date-picker [options]=\"myDatePickerOptions\" (dateChanged)=\"onDateChanged($event,'from')\" class=\"pull-right\"></my-date-picker>\r\n                </div>\r\n\r\n                <div class=\"tab-content clearfix img-thumbnail\" style=\"width:200%\">\r\n\r\n                    <div class=\"tab-pane active\" id=\"1a\" *ngIf=\"clickedTab=='Overview'\">\r\n                        <zingchart *ngFor=\"let chart of barcharts\" [chart]=\"chart\" ></zingchart>\r\n                    </div>\r\n                    \r\n                    <div class=\"tab-pane\" id=\"2a\" *ngIf=\"clickedTab=='Surveys'\">\r\n                        <div class=\"pull-right\">\r\n                            <a (click)=\"export('pdf')\" class=\"btn btn-default\">Export To PDF</a>\r\n                            <a (click)=\"export('excel')\" class=\"btn btn-default\">Export To Excel</a>\r\n                        </div>\r\n                        <zingchart *ngFor=\"let chart of piecharts\" [chart]=\"chart\" ></zingchart>\r\n                    </div>\r\n                \r\n                    <div class=\"tab-pane\" id=\"3a\" *ngIf=\"clickedTab=='Ratings'\">\r\n                        <zingchart *ngFor=\"let chart of stackedbarcharts\" [chart]=\"chart\" ></zingchart>\r\n                    </div>\r\n                    \r\n                    <div class=\"tab-pane\" id=\"4a\" *ngIf=\"clickedTab=='Branches'\">\r\n                        <zingchart *ngFor=\"let chart of charts\" [chart]=\"chart\" ></zingchart>\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n        </my-content>\r\n       `  \r\n   })\r\n   export class ReportComponent implements OnInit, OnDestroy {\r\n        \r\n     charts: any; //Chart[];\r\n\r\n     barcharts: any;\r\n\r\n     lineChart;\r\n\r\n     piecharts: any;\r\n\r\n     stackedbarcharts: any;\r\n\r\n     private _options = {\r\n        position: [\"top\", \"right\"],\r\n        timeOut: 9000,\r\n        lastOnBottom: true\r\n    }\r\n\r\n     myDatePickerOptions = {\r\n        todayBtnTxt: 'Today',\r\n        dateFormat: 'yyyy-mm-dd',\r\n        firstDayOfWeek: 'mo',\r\n        sunHighlight: true,\r\n        height: '34px',\r\n        width: '260px',\r\n        inline: false,\r\n        disableUntil: {year: 2016, month: 8, day: 10},\r\n        selectionTxtFontSize: '16px'\r\n    };\r\n\r\n     private clickedTab = 'Overview';\r\n\r\n     private fromDatePickerSet; \r\n\r\n     private dateFilter: Array<any> = [];\r\n\r\n     constructor (\r\n                    private _reportService: ReportService, \r\n                    private _notification: NotificationsService,\r\n                    private _fileService: FileService) {\r\n\r\n        this.charts = [\r\n          {\r\n            id: 'chart-1',\r\n            data: {\r\n              title: {\r\n                \"text\": \"Surveys & Responses\",\r\n                \"font-size\": \"24px\",\r\n                \"adjust-layout\":true\r\n              },\r\n              plotarea: {\r\n                \"margin\": \"dynamic 45 60 dynamic\",\r\n              },\r\n              legend: {\r\n                \"layout\": \"float\",\r\n                \"background-color\": \"none\",\r\n                \"border-width\": 0,\r\n                \"shadow\": 0,\r\n                \"align\":\"center\",\r\n                \"adjust-layout\":true,\r\n                \"item\":{\r\n                \"padding\": 7,\r\n                \"marginRight\": 17,\r\n                \"cursor\":\"hand\"\r\n                }\r\n              },\r\n              \"type\": \"line\", \r\n              \"series\": [ \r\n                {\"values\":[20,40,25,50,15,45,33,34]}, \r\n                {\"values\":[5,30,21,18,59,50,28,33]}, \r\n                {\"values\":[30,5,18,21,33,41,29,15]} \r\n              ] \r\n            },\r\n            height: 600,\r\n            width: '100%',\r\n            \"scale-x\":{\r\n              \"values\":\"0:35:7\",\r\n              \"format\":\"Day %v\"\r\n            },\r\n            \"scale-y\":{\r\n              \"values\":\"0:100:20\",\r\n              \"format\":\"%v%\",\r\n              \"guide\":{\r\n                \"line-style\":\"dashdot\"\r\n              }\r\n            }\r\n          }\r\n        ];\r\n\r\n        this.stackedbarcharts = [\r\n          {\r\n            id: 'chart-4',\r\n            data: {\r\n              \"type\": \"bar3d\",\r\n              \"plot\":{\r\n                \"stacked\":true,\r\n                \"stack-type\":\"normal\" /* Optional specification */\r\n              }, \r\n              \"series\": [ \r\n                {\"values\":[20,40,25,50,15,45,33,34]}, \r\n                {\"values\":[5,30,21,18,59,50,28,33]}, \r\n                {\"values\":[30,5,18,21,33,41,29,15]} \r\n              ]\r\n            },\r\n            height: 600,\r\n            width: '100%'\r\n            }\r\n        ];\r\n\r\n      }\r\n\r\n      ngOnInit(){\r\n            //Fetch Overview Report\r\n            var obj = {};\r\n            obj['from'] = '';\r\n            obj['tab'] = this.clickedTab;\r\n            obj['to'] = '';\r\n            this.dateFilter.push(obj);\r\n            this.getReport(this.dateFilter);\r\n            this.dateFilter=[];\r\n      }\r\n\r\n      ngOnDestroy(){\r\n\r\n      }\r\n\r\n      getReport(filter){\r\n        \r\n        this._reportService.getReport(filter).subscribe(\r\n            result => {\r\n                if(this.clickedTab=='Overview') {\r\n                    this.barcharts = result.report;\r\n                }else if(this.clickedTab=='Surveys'){\r\n                    this.piecharts= result.report;\r\n                }\r\n                this._notification.success('Success', 'Reports updated...')\r\n            },\r\n            error => this._notification.error('Error', error)\r\n        );\r\n\r\n      }\r\n\r\n      onDateChanged(event:any, option) {\r\n        if(new Date(event.jsdate).toLocaleDateString() == \"1/1/1970\") {\r\n            this.fromDatePickerSet = '';\r\n            return;\r\n        }\r\n        if(option=='from') {\r\n            this.fromDatePickerSet = new Date(event.jsdate).toLocaleDateString();\r\n        }else if(option=='to') { \r\n            var obj = {};\r\n            obj['from'] = this.fromDatePickerSet;\r\n            obj['tab'] = this.clickedTab;\r\n            obj['to'] = new Date(event.jsdate).toLocaleDateString();\r\n            this.dateFilter.push(obj);\r\n            //FETCH REPORT\r\n            this.getReport(this.dateFilter);\r\n            this.fromDatePickerSet='';\r\n            this.dateFilter=[];\r\n        }\r\n        //console.log('onDateChanged(): ', event.date, ' - jsdate: ', new Date(event.jsdate).toLocaleDateString(), ' - formatted: ', event.formatted, ' - epoc timestamp: ', event.epoc);\r\n      }\r\n\r\n      export(fileType){\r\n\r\n        this._notification.info('Info', `Generating ${fileType} report. This may take long depending on the size of data`);\r\n        this._fileService.generate('surveys', fileType)\r\n                    .subscribe(\r\n                        success => window.open(this._fileService.printReport(success.file, fileType)),\r\n                        error => this._notification.error('Error', `Error generating ${fileType} report`)\r\n                    );\r\n    }\r\n\r\n    updateReport(){\r\n        var obj = {};\r\n        obj['from'] = new Date().toLocaleDateString();\r\n        obj['tab'] = this.clickedTab;\r\n        obj['to'] = new Date().toLocaleDateString();\r\n        this.dateFilter.push(obj);\r\n        this.getReport(this.dateFilter);\r\n        this.fromDatePickerSet='';\r\n        this.dateFilter=[];\r\n    }\r\n       \r\n   }"],"sourceRoot":"/source/"}