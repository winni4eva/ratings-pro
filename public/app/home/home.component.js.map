{"version":3,"sources":["home/home.component.ts"],"names":[],"mappings":"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","file":"home/home.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { SurveyService } from '../admin2/survey/survey.service';\r\nimport { HomeService } from './home.service';\r\nimport { CategoryService } from '../admin2/category/category.service';\r\n\r\n\r\n@Component({\r\n    selector: 'my-home',\r\n    template:\r\n     `\r\n        <style>\r\n            body {\r\n                background: url(../images/bg-body.jpg) repeat left top;\r\n                color: #515151;\r\n                font-family: Arial, Helvetica, sans-serif;\r\n                font-size: 14px;\r\n                margin: 0;\r\n                min-width: 960px;\r\n                padding: 0;\r\n                border: 2px solid black;\r\n            }\r\n        </style>\r\n\r\n        <body>\r\n\r\n        <div id=\"header\">\r\n            <div>\r\n                <div id=\"logo\">\r\n                    <a [routerLink]=\"['/admin/view_branches']\"><img src=\"images/logo.png\" alt=\"Logo\"></a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\t<div id=\"body\" style=\"\">\r\n\r\n\t\t<div>\r\n\t\t\t<div>\r\n\t\t\t\t<!-- Content -->\r\n                <div [ngSwitch]=\"_step\">\r\n\r\n                    <!-- Step 1 -->\r\n                    <div *ngSwitchCase=\"1\" style=\"width:100% !important\">\r\n                        <ul style=\"width:90%;height:60%; margin-left:4% !important\">\r\n                            <li style=\"margin:1%;float:left;width:20%;height:50% !important\" *ngFor=\"let category of _categories\">\r\n                                <a (click)=\"getSurveys(category?.id)\" style=\"cursor:pointer\">\r\n                                    <!--<h4 style=\"margin-left:-20px;margin-bottom:-3px\">{{category?.name}}</h4>-->\r\n                                    <img [src]=\"category.image.src\" class=\"img-thumbnail\" style=\"width:500px;height:600px\"/>\r\n                                </a>                               \r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <!-- Step 1 -->\r\n\r\n                    <!-- Step 2 -->\r\n                    <div *ngSwitchCase=\"2\">\r\n     \r\n                        <div>\r\n                            <div>\r\n                                <!--\r\n                                <p style=\"text-align:center\">{{(_currentQuestion+1)}} Out Of {{_numberOfQuestions}}</p>\r\n                                -->\r\n                                <p style=\"font-size:40px\">\r\n                                    {{_questions[_currentQuestion]?.question}}\r\n                                </p>\r\n                            </div>\r\n                            <!--<p><a (change)=\"testNextQuestion(3)\" class=\"btn btn-default\">test</a></p>-->\r\n                            <div style=\"width:150%;margin-top:-180px\">\r\n                                    <ul>\r\n                                        <li style=\"margin:0.1%\" *ngFor=\"let answer of _questions[_currentQuestion]?.answers\">\r\n                                            <a (click)=\"getNextQuestion(answer?.response?.id);onEvent($event)\" style=\"cursor:pointer\"> \r\n                                            <img class=\"img-thumbnail\" style=\"z-index:8\" [src]=\"answer?.response?.rater?.image?.src\" alt=\"Image\" *ngIf=\"answer?.response?.rater\"> \r\n                                            \r\n                                            <div class=\"btn active\" style=\"margin:0px;border:2px solid black\">\r\n                                                <input type=\"checkbox\" name='email1' checked style=\"visibility:hidden\"> \r\n                                                <span>{{answer?.response?.name}}</span>\r\n                                            </div>\r\n                                            </a>                               \r\n                                        </li>\r\n                                    </ul>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <p><a (click)=\"previousStep()\" style=\"cursor:pointer\">Previous</a></p>\r\n                    </div>\r\n                    <!-- Step 4 -->\r\n\r\n                    <!-- Default -->\r\n                    <div *ngSwitchDefault>\r\n                        <p>Default Step</p>\r\n                    </div>\r\n                    <!-- Default -->\r\n\r\n                </div>\r\n                <!-- Content -->\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n    <!--\r\n\t<div id=\"footer\">\r\n\t\t<div>\r\n\t\t\t<div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<p class=\"footnote\">\r\n\t\t\t&copy; Copyright KRIF. All rights reserved.\r\n\t\t</p>\r\n\t</div>\r\n    -->\r\n    </body>\r\n    `\r\n})\r\n\r\nexport class HomeComponent implements OnInit{\r\n\r\n    private _surveys;\r\n\r\n    private _categories;\r\n\r\n    private _tests: Array<any> = []; \r\n\r\n    private _questions; \r\n\r\n    private _step: number = 1;\r\n\r\n    private _surveyId: number;\r\n\r\n    //private _selectedBranch: number;\r\n\r\n    //private _selectedCategory: number;\r\n\r\n    //private _selectedTest: number;\r\n\r\n    private _numberOfQuestions: number = 0;\r\n\r\n    private _currentQuestion: number = 0;\r\n\r\n    protected _previous_answer: number = 0;\r\n\r\n    private _ratings = []; \r\n\r\n    private _branchId;\r\n\r\n    constructor(\r\n                private _surveyService: SurveyService,\r\n                private _homeService: HomeService,\r\n                private _categoryService: CategoryService){}\r\n\r\n    ngOnInit(){\r\n\r\n        this._categoryService.getCategories().subscribe(\r\n            result => this._categories = result.categories,\r\n            error => console.log(error)\r\n        );\r\n\r\n        this._homeService.getUserSurveys().subscribe(\r\n            result => {\r\n                this._surveys = result.resource.surveys;\r\n                this._branchId = result.resource.branch_id;\r\n            },\r\n            error => console.log(error)\r\n        );\r\n    }\r\n\r\n    nextStep(){\r\n        if(this._step < 2){\r\n            //console.log(`Step is ${this._step} move to step 1`); \r\n            this._step += 1;\r\n        }else {\r\n            this.previousStep();\r\n            //console.log(`Step is ${this._step} add 1 step`);\r\n            //this._step += 1;\r\n        }\r\n    }\r\n\r\n    previousStep(){\r\n        if(this._step > 1 ) \r\n            this._step -= 1;\r\n    }\r\n\r\n    getSurveys(categoryId){\r\n        this._tests = [];\r\n        \r\n        for(let survey of this._surveys){\r\n            if(survey.category_id === categoryId && survey.active == 1){\r\n                this._questions = survey.questions;\r\n                this._surveyId = survey.id;\r\n                this.nextStep();\r\n                return\r\n            }\r\n         }\r\n\r\n        alert(\"This category has no survey's to display\");\r\n\r\n    }\r\n\r\n    getNextQuestion(answerId){\r\n        console.log('You answered a question');\r\n        if(this._questions[this._currentQuestion].probe_questions.length > 0){\r\n            console.log('Found another probe question');\r\n            switch (this._questions[this._currentQuestion].probe_questions[0].equality) {\r\n                case '*':\r\n                    this._questions.forEach((question, index) => {\r\n                        //console.log(\"Question Key => \"+ index);\r\n                        if(question.id == this._questions[this._currentQuestion].probe_questions[0].next_question) {\r\n                            //console.log(\"Current question => \"+ index);\r\n                            this._currentQuestion = index;\r\n                        }\r\n                    });\r\n                    break;\r\n                case '==':\r\n                     if(this._questions[this._currentQuestion].probe_questions[0].expected_answer == answerId){\r\n\r\n                        this._questions.forEach((question, index) => {\r\n                            //console.log(\"Question Key => \"+ index);\r\n                            if(question.id == this._questions[this._currentQuestion].probe_questions[0].next_question) {\r\n                                //console.log(\"Current question => \"+ index);\r\n                                this._currentQuestion = index;\r\n                            }\r\n                        });\r\n                    }\r\n                    break;\r\n                case '!=':\r\n                    if(this._questions[this._currentQuestion].probe_questions[0].expected_answer != answerId){\r\n\r\n                        this._questions.forEach((question, index) => {\r\n                            //console.log(\"Question Key => \"+ index);\r\n                            if(question.id == this._questions[this._currentQuestion].probe_questions[0].next_question) {\r\n                                //console.log(\"Current question => \"+ index);\r\n                                this._currentQuestion = index;\r\n                            }\r\n                        });\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n\r\n            this._previous_answer = answerId;\r\n            \r\n        }else{\r\n\r\n            console.log(\"This Question Has No Further Probes\");\r\n            this._ratings.push(\r\n                 {\r\n                     question_id: this._questions[this._currentQuestion].id,\r\n                     response_id: answerId,\r\n                     previous_response_id: this._previous_answer,\r\n                     branch_id: this._branchId,//ToDO return user branch Id\r\n                     survey_id: this._surveyId\r\n                 }\r\n             );\r\n\r\n            //Save rating\r\n            //console.log(this._ratings);\r\n            console.log('Saving Rating');\r\n            //this._ratings=[];\r\n            this._homeService.addRating(this._ratings).subscribe(\r\n                result => {\r\n                    console.log(result.success);\r\n                    alert(\"Thank you for taking this survey...\");\r\n                    this._ratings=[];\r\n                    this._currentQuestion=0;\r\n                    this._step=1;\r\n                },\r\n                error => {\r\n                    console.log(error);\r\n                    alert(\"There was an error saving your survey please try again or contact IT dept for support..\");\r\n                }\r\n            );\r\n\r\n        }\r\n        // response_id: answerId,);\r\n        // let qtnNumber = this._currentQuestion + 1;\r\n        \r\n        // if( qtnNumber <= this._numberOfQuestions){\r\n        //     this._ratings.push(\r\n        //         {\r\n        //             question_id: this._questions[this._currentQuestion].id,\r\n        //             response_id: answerId,\r\n        //             previous_response_id: answerId,\r\n        //             branch_id: this._selectedBranch\r\n        //         }\r\n        //     );\r\n        //     this._currentQuestion += 1;\r\n        //     if(qtnNumber < this._numberOfQuestions) return;\r\n        // }\r\n        // this._step = 1;\r\n        // this._currentQuestion = 0;\r\n        // this.getCategories(this._selectedBranch);\r\n        // alert(\"Thank you for taking this survey..\");\r\n        \r\n        //Save rating\r\n        // this._homeService.addRating(this._ratings).subscribe(\r\n        //     result => {\r\n        //         console.log(result.success);\r\n        //         this._ratings=[];\r\n        //     },\r\n        //     error => console.log(error)\r\n        // );\r\n    }\r\n\r\n    testNextQuestion(id){\r\n        console.log(`Answer is => ${id}`);\r\n    }\r\n\r\n    onEvent(event) {\r\n        console.log('Stopping propagation');\r\n        event.stopPropagation();\r\n    }\r\n\r\n\r\n}\r\n\r\n"],"sourceRoot":"/source/"}